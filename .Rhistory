setwd("C:/Users/jscot/OneDrive/Documents/GitHub/tutorial1/Data-analysis-Grp1")
#| label: fig-1
#| fig-cap: barchart of proportion of individuals of each sex are obese
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$Obese<-as.factor(df$Obese)
ggplot(df, aes(x = Obese, group = Sex)) +
geom_bar(aes(y = after_stat(prop), fill = Sex),
stat = "count", position = "dodge") +
labs(y = "Proportion", fill = "Sex")+
ggtitle("Obesity Rate by Sex")
#| echo: false
#| warning: false
#| message: false
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidymodels)
library(sjPlot)
library(performance)
library(kableExtra)
library(gt)
library(tidyr)
library(ggplot2)
library(moderndive)
library(sjPlot)
library(tidymodels)
library(broom)
library(performance)
library(faraway)
library(palmerpenguins)
#| label: fig-1
#| fig-cap: barchart of proportion of individuals of each sex are obese
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$Obese<-as.factor(df$Obese)
ggplot(df, aes(x = Obese, group = Sex)) +
geom_bar(aes(y = after_stat(prop), fill = Sex),
stat = "count", position = "dodge") +
labs(y = "Proportion", fill = "Sex")+
ggtitle("Obesity Rate by Sex")
#| label: fig-2
#| fig-cap: box plot of obesity over the years
ggplot(data = df,
aes(x = Obese, group = as.factor(Year)))+
geom_bar(aes(y = after_stat(prop), fill = as.factor(Year)),
stat = "count", position = "dodge")
#| label: fig-1
#| fig-cap: barchart of proportion of individuals of each sex are obese
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$Obese<-as.factor(df$Obese)
ggplot(df, aes(x = Obese, group = Sex)) +
geom_bar(aes(y = after_stat(prop), fill = Sex),
stat = "count", position = "dodge") +
labs(y = "Proportion", fill = "Sex")+
ggtitle("Obesity Rate by Sex")
#| echo: false
#| warning: false
#| message: false
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidymodels)
library(sjPlot)
library(performance)
library(kableExtra)
library(gt)
library(tidyr)
library(ggplot2)
library(moderndive)
library(sjPlot)
library(tidymodels)
library(broom)
library(performance)
library(faraway)
library(palmerpenguins)
#| label: fig-1
#| fig-cap: barchart of proportion of individuals of each sex are obese
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$Obese<-as.factor(df$Obese)
ggplot(df, aes(x = Obese, group = Sex)) +
geom_bar(aes(y = after_stat(prop), fill = Sex),
stat = "count", position = "dodge") +
labs(y = "Proportion", fill = "Sex")+
ggtitle("Obesity Rate by Sex")
#| label: fig-1
#| fig-cap: barchart of proportion of individuals of each sex are obese
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$Obese<-as.factor(df$Obese)
ggplot(df, aes(x = Obese, group = Sex)) +
geom_bar(aes(y = after_stat(prop), fill = Sex),
stat = "count", position = "dodge") +
labs(x="Obesity Status", y = "Proportion", fill = "Sex")+
ggtitle("Obesity Rate by Sex")
#| label: fig-2
#| fig-cap: box plot of obesity over the years
ggplot(data = df,
aes(x = Obese, group = Year))+
geom_bar(aes(y = after_stat(prop), fill = Year),
stat = "count", position = "dodge")+
labs(x="Obesity Status", y="Proportion", title="Obesity Rates over the Years")
#| label: fig-2
#| fig-cap: box plot of obesity over the years
ggplot(data = df,
aes(x = Obese, group = Year))+
geom_bar(aes(y = after_stat(prop), fill = as.factor(Year),
stat = "count", position = "dodge")+
labs(x="Obesity Status", y="Proportion", title="Obesity Rates over the Years")
#| label: fig-2
#| fig-cap: box plot of obesity over the years
ggplot(data = df,
aes(x = Obese, group = as.factr(Year)))+
geom_bar(aes(y = after_stat(prop), fill = as.factor(Year),
stat = "count", position = "dodge")+
labs(x="Obesity Status", y="Proportion", title="Obesity Rates over the Years")
ggplot(data = df,
aes(x = Obese, group = as.factor(Year)))+
geom_bar(aes(y = after_stat(prop), fill = as.factor(Year),
stat = "count", position = "dodge"))+
labs(x="Obesity Status", y="Proportion", title="Obesity Rates over the Years")
#| label: fig-2
#| fig-cap: box plot of obesity over the years
ggplot(data = df,
aes(x = Obese, group = as.factor(Year)))+
geom_bar(aes(y = after_stat(prop), fill = as.factor(Year),
stat = "count"), position = "dodge")+
labs(x="Obesity Status", y="Proportion", title="Obesity Rates over the Years")
#| label: fig-2
#| fig-cap: box plot of obesity over the years
ggplot(data = df,
aes(x = Obese, group = as.factor(Year)))+
geom_bar(aes(y = after_stat(prop), fill = as.factor(Year),
stat = "count"), position = "dodge")+
labs(x="Obesity Status", y="Proportion", title="Obesity Rates over the Years", fill="Year")
#| label: fig-1
#| fig-cap: barchart of proportion of individuals of each sex are obese
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$Obese<-as.factor(df$Obese)
ggplot(df, aes(x = Obese, group = Sex)) +
geom_bar(aes(y = after_stat(prop), fill = Sex),
stat = "count", position = "dodge") +
labs(y = "Proportion", fill = "Sex")+
ggtitle("Obesity Rate by Sex")
#| label: fig-2
#| fig-cap: box plot of obesity over the years
ggplot(data = df,
aes(x = Obese, group = as.factor(Year)))+
geom_bar(aes(y = after_stat(prop), fill = as.factor(Year)),
stat = "count", position = "dodge")
#| label: tbl-sum
#| tbl-cap: Summary Table
model <- glm(Obese ~ Sex+Year, data = df,family = binomial)
model %>% broom::tidy()%>% gt()
plot_model(model,
type = "pred",
terms = "Sex",
axis.title = c("Sex",
"Prob. of being obese"),
title = " ")
plot_model(model,
type = "pred",
title = "",
terms="Year",
axis.title = c("year", "Prob. of obesity"))
df$AgeGroup<-as.factor(df$AgeGroup)
df$Veg<-as.factor(df$Veg)
df$Fruit<-as.factor(df$Fruit)
df$Employment<-as.factor(df$Employment)
#| label: fig-1
#| fig-cap: barchart of proportion of individuals of each sex are obese
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$AgeGroup<-as.factor(df$AgeGroup)
df$Veg<-as.factor(df$Veg)
df$Fruit<-as.factor(df$Fruit)
df$Obese<-as.factor(df$Obese)
df$Employment<-as.factor(df$Employment)
ggplot(df, aes(x = Obese, group = Sex)) +
geom_bar(aes(y = after_stat(prop), fill = Sex),
stat = "count", position = "dodge") +
labs(x="Obesity Status", y = "Proportion", fill = "Sex")+
ggtitle("Obesity Rate by Sex")
?n_count
?ncount
#| label: fig-2
#| fig-cap: Regression line looking at difference in obesity rates over the years
ObeseRate<-df%>%
summarise(Rate=n(Obese=="No")/n(), .by="Year")
#| label: fig-2
#| fig-cap: Regression line looking at difference in obesity rates over the years
ObeseRate<-df%>%
summarise(Rate=n(df$Obese=="Yes")/n(), .by="Year")
#| label: fig-2
#| fig-cap: Regression line looking at difference in obesity rates over the years
ObeseRate<-df%>%
summarise(Rate=n(filter(Obese=="Yes"))/n(), .by="Year")
#| label: fig-2
#| fig-cap: Regression line looking at difference in obesity rates over the years
ObeseRate<-df%>%
summarise(Rate=n(filter(df$Obese=="Yes"))/n(), .by="Year")
?n_distinct
#| label: fig-2
#| fig-cap: Regression line looking at difference in obesity rates over the years
ObeseRate<-df%>%
summarise(Rate=n(df$Obese=="Yes")/n(), .by="Year")
#| label: fig-2
#| fig-cap: Regression line looking at difference in obesity rates over the years
ObeseRate<-df%>%
group_by(Year)%>%
filter(Obese=="Yes")
View(ObeseRate)
nrow(ObeseRate[Year==2016,])
nrow(ObeseRate[ObeseRate$Year==2016,])
#| label: fig-2
#| fig-cap: Regression line looking at difference in obesity rates over the years
ObeseRate<-df%>%
group_by(Year)%>%
filter(Obese=="Yes")%>%
nrow(ObeseRate[ObeseRate$Year==2016,])/nrow(df$Year==2016)
nrow(ObeseRate[ObeseRate$Year==2016,])/nrow(df$Year==2016)
nrow(ObeseRate[ObeseRate$Year==2016,])/nrow(df[df$Year==2016,])
#| label: fig-2
#| fig-cap: box plot of obesity over the years
ggplot(data = df,
aes(x = Obese, group = as.factor(Year)))+
geom_bar(aes(y = after_stat(prop), fill = as.factor(Year),
stat = "count"), position = "dodge")+
labs(x="Obesity Status", y="Proportion", title="Obesity Rates over the Years", fill="Year")
#| label: fig-2
#| fig-cap: box plot of obesity over the years
ggplot(data = df,
aes(x = Year, group = Obese)+
geom_bar(aes(y = after_stat(prop), fill = Obese,
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Obesity Status")
#| label: fig-2
#| fig-cap: box plot of obesity over the years
ggplot(data = df,
aes(x = Year, group = Obese))+
geom_bar(aes(y = after_stat(prop), fill = Obese,
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Obesity Status")
#| label: fig-2
#| fig-cap: bar plot of obesity over the years
ggplot(data = df,
aes(x = Year, group = Obese))+
geom_bar(aes(y = after_stat(prop), fill = Obese,
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Obesity Status")+
facet_wrap(Sex)
#| label: fig-2
#| fig-cap: bar plot of obesity over the years
ggplot(data = df,
aes(x = Year, group = Obese))+
geom_bar(aes(y = after_stat(prop), fill = Obese,
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Obesity Status")+
facet_wrap(df$Sex)
#| label: fig-3
#| fig-cap: bar plot of obesity over the years
ggplot(data = df,
aes(x = Year, group = Obese))+
geom_bar(aes(y = after_stat(prop), fill = Obese,
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Obesity Status")+
facet_wrap(df$Fruit)
#| label: fig-3
#| fig-cap: bar plot of obesity over the years
ggplot(data = df,
aes(x = Year, group = Obese))+
geom_bar(aes(y = after_stat(prop), fill = Obese,
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Obesity Status")+
facet_wrap(df$Fruit)
ggplot(data = df,
aes(x = Year, group = Obese))+
geom_bar(aes(y = after_stat(prop), fill = Obese,
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Obesity Status")+
facet_wrap(df$Veg)
#| label: fig-2
#| fig-cap: bar plot of obesity over the years
ggplot(data = df,
aes(x = Year, group = Sex))+
geom_bar(aes(y = after_stat(prop), fill = Sex,
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Sex")+
facet_wrap(df$Obese)
#| label: fig-2
#| fig-cap: bar plot of obesity over the years
ggplot(data = df,
aes(x = Year, group = Sex))+
geom_point(aes(y = after_stat(prop), colour = Sex,
stat = "count"))+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Sex")+
facet_wrap(df$Obese)
#| label: fig-2
#| fig-cap: bar plot of obesity over the years
ggplot(data = df,
aes(x = Year, group = Sex))+
geom_bar(aes(y = after_stat(prop), fill = Sex,
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Sex")+
facet_wrap(df$Obese)
#| label: fig-2
#| fig-cap: bar plot of obesity over the years
ggplot(data = df,
aes(x = Year))+
geom_bar(aes(y = after_stat(prop),
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years")+
facet_wrap(df$Obese)
df$FV<-ifelse(df$Fruit=="Yes"&df$Veg=="Yes", df$FV=="Yes", df$FV=="No")
df$FV<-ifelse(df$Fruit=="Yes"&df$Veg=="Yes", "Yes", "No")
df$FV<-as.factor(ifelse(df$Fruit=="Yes"&df$Veg=="Yes", "Yes", "No"))
#| label: fig-1
#| fig-cap: barchart of proportion of individuals of each sex are obese
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$AgeGroup<-as.factor(df$AgeGroup)
df$Veg<-as.factor(df$Veg)
df$Fruit<-as.factor(df$Fruit)
df$Obese<-as.factor(df$Obese)
df$Employment<-as.factor(df$)
#| label: fig-1
#| fig-cap: barchart of proportion of individuals of each sex are obese
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$AgeGroup<-as.factor(df$AgeGroup)
df$Veg<-as.factor(df$Veg)
df$Fruit<-as.factor(df$Fruit)
df$Obese<-as.factor(df$Obese)
df$Employment<-as.factor(df$Employment)
ggplot(df, aes(x = Obese, group = Sex)) +
geom_bar(aes(y = after_stat(prop), fill = Sex),
stat = "count", position = "dodge") +
labs(x="Obesity Status", y = "Proportion", fill = "Sex")+
ggtitle("Obesity Rate by Sex")
ggplot(df, aes(x = Obese, group = Fruit)) +
geom_bar(aes(y = after_stat(prop), fill = Fruit),
stat = "count", position = "dodge") +
labs(x="Obesity Status", y = "Proportion", fill = "Eating Recommended Fruit")+
ggtitle("Obesity Rate by Fruit")
ggplot(df, aes(x = Obese, group = Veg)) +
geom_bar(aes(y = after_stat(prop), fill = Veg),
stat = "count", position = "dodge") +
labs(x="Obesity Status", y = "Proportion", fill = "Eating Recommended Veg")+
ggtitle("Obesity Rate by Veg")
df$FV<-as.factor(ifelse(df$Fruit=="Yes"&df$Veg=="Yes", "Yes", "No"))
ggplot(df, aes(x = Obese, group = FV)) +
geom_bar(aes(y = after_stat(prop), fill = FV),
stat = "count", position = "dodge") +
labs(x="Obesity Status", y = "Proportion", fill = "Eating Recommended Fruit and Veg")+
ggtitle("Obesity Rate by Fruit Veg")
ggplot(df, aes(x = Fruit, group = Obese)) +
geom_bar(aes(y = after_stat(prop), fill = Obese),
stat = "count", position = "dodge") +
labs(x="Eating Recommended Fruit", y = "Proportion", fill = "Obesity Status")+
ggtitle("Obesity Rate by Fruit")
ggplot(data = df,
aes(x = Year, group = Obese))+
geom_bar(aes(y = after_stat(prop), fill = Obese,
stat = "count"), position = "dodge")+
labs(x="Year", y="Proportion", title="Obesity Rates over the Years", fill="Obesity Status")+
facet_wrap(df$FV)
#| label: tbl-sum
#| tbl-cap: Summary Table
model <- glm(Obese ~ Sex+Year+FV+Fruit+Veg+AgeGroup+Employment, data = df,family = binomial)
model %>% broom::tidy()%>% gt()
ggplot(df, aes(x = AgeGroup, group = Obese)) +
geom_bar(aes(y = after_stat(prop), fill = Obese),
stat = "count", position = "dodge") +
labs(x="AgeGroup", y = "Proportion", fill = "Obesity Status")+
ggtitle("Obesity Rate by Fruit")
ggplot(df, aes(x = Employment, group = Obese)) +
geom_bar(aes(y = after_stat(prop), fill = Obese),
stat = "count", position = "dodge") +
labs(x="Employment Status", y = "Proportion", fill = "Obesity Status")+
ggtitle("Obesity Rate by Employment Status")
ggplot(df, aes(x = Obese, group = Employment)) +
geom_bar(aes(y = after_stat(prop), fill = Employment),
stat = "count", position = "dodge") +
labs(x="Obesity Status", y = "Proportion", fill = "Employment Status")+
ggtitle("Obesity Rate by Employment Status")
plot_model(model,
type = "pred",
terms = "Sex",
axis.title = c("Sex",
"Prob. of being obese"),
title = " ")
plot_model(model,
type = "pred",
title = "",
terms="Year",
axis.title = c("year", "Prob. of obesity"))
plot_model(model,
type = "pred",
terms = "AgeGroup",
axis.title = c("Age Group",
"Prob. of being obese"),
title = " ")
plot_model(model,
type = "pred",
terms = "Employment",
axis.title = c("Employment",
"Prob. of being obese"),
title = " ")
plot_model(model,
type = "pred",
terms = "Fruit",
axis.title = c("Fruit",
"Prob. of being obese"),
title = " ")
plot_model(model,
type = "pred",
terms = "Veg",
axis.title = c("Veg",
"Prob. of being obese"),
title = " ")
plot_model(model,
type = "pred",
terms = "FV",
axis.title = c("Fruit and Veg",
"Prob. of being obese"),
title = " ")
library(performance)
check_model(model, panel = TRUE)
library(performance)
check_model(model, panel = TRUE)
