df<-read.csv("DAProject3.csv")
View(df)
df$Employment<-as.factor(df$Employment)
df$AgeGroup<-as.factor(df$AgeGroup)
df$Veg<-as.factor(df$Veg)
df$Fruit<-as.factor(df$Fruit)
df$Obese<-as.factor(df$Obese)
df$Employment<-as.factor(df$Employment)
df$FV<-as.factor(ifelse(df$Fruit=="Yes"|df$Veg=="Yes", "Yes", "No"))
View(df)
levels(df$Employment)
df$Employment<-ifelse(df$Employment=="In full-time education"|df$Employment=="In paid employment, self-employed or on gov't training", "Employed/Full-Time Training or Education",)
df$Employment<-ifelse(df$Employment=="In full-time education"|df$Employment=="In paid employment, self-employed or on gov't training", "Employed/Full-Time Training or Education",ifelse(df$Employment=="Retired", "Retired", "Unemployed/Other"))
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$AgeGroup<-as.factor(df$AgeGroup)
df$Veg<-as.factor(df$Veg)
df$Fruit<-as.factor(df$Fruit)
df$Obese<-as.factor(df$Obese)
df$Employment<-as.factor(ifelse(df$Employment=="In full-time education"|df$Employment=="In paid employment, self-employed or on gov't training", "Employed/Full-Time Training or Education",ifelse(df$Employment=="Retired", "Retired", "Unemployed/Other")))
df$FV<-as.factor(ifelse(df$Fruit=="Yes"|df$Veg=="Yes", "Yes", "No"))
df<-read.csv("DAProject3.csv")
df<-read.csv("DAProject3.csv")
df$Sex<-as.factor(df$Sex)
df$AgeGroup<-as.factor(df$AgeGroup)
df$Veg<-as.factor(df$Veg)
df$Fruit<-as.factor(df$Fruit)
df$Obese<-as.factor(df$Obese)
df$Employment<-as.factor(df$Employment)
df$Employment_Clean<-as.factor(ifelse(df$Employment=="In full-time education"|df$Employment=="In paid employment, self-employed or on gov't training", "Employed/Full-Time Training or Education",ifelse(df$Employment=="Retired", "Retired", "Unemployed/Other")))
df$FV<-as.factor(ifelse(df$Fruit=="Yes"|df$Veg=="Yes", "Yes", "No"))
#| echo: false
#| results: hide
mod1 <- glm(Obese ~ Sex + Year + FV + AgeCategory + Employment_Clean, data = df, family = binomial)
mod1 %>% broom::tidy() %>% gt()
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidymodels)
library(sjPlot)
library(performance)
library(kableExtra)
library(gt)
df <- read.csv("DAProject3.csv")
df <- df %>%
mutate(
Sex = as.factor(Sex),
AgeGroup = as.factor(AgeGroup),
Veg = as.factor(Veg),
Fruit = as.factor(Fruit),
Obese = as.factor(Obese),
Employment = as.factor(Employment)
)
df$Employment_Clean <- as.factor(ifelse(df$Employment == "In full-time education" | df$Employment =="In paid employment, self-employed or on gov't training", "Employed/Full-Time Training or Education", ifelse(df$Employment == "Retired", "Retired", "Unemployed/Other")))
df$FV <- as.factor(ifelse(df$Fruit == "Yes" | df$Veg == "Yes", "Yes", "No"))
df$AgeCategory <- as.factor(ifelse(df$AgeGroup %in% c("16-24", "25-34"), "Young",
ifelse(df$AgeGroup %in% c("35-44", "45-54", "55-64"), "Middle-aged",
"Old")))
df$AgeCategory <- relevel(df$AgeCategory, ref = "Young")
#| echo: false
#| results: hide
mod1 <- glm(Obese ~ Sex + Year + FV + AgeCategory + Employment_Clean, data = df, family = binomial)
mod1 %>% broom::tidy() %>% gt()
AIC(mod1)
#| echo: false
#| results: hide
mod2 <- glm(Obese ~ Year, data = df, family = binomial)
mod2 %>% broom::tidy()%>% gt()
AIC(mod2)
#| echo: false
#| warning: false
#| message: false
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidymodels)
library(sjPlot)
library(performance)
library(kableExtra)
library(gt)
df <- read.csv("DAProject3.csv")
df <- df %>%
mutate(
Sex = as.factor(Sex),
AgeGroup = as.factor(AgeGroup),
Veg = as.factor(Veg),
Fruit = as.factor(Fruit),
Obese = as.factor(Obese),
Employment = as.factor(Employment)
)
df$Employment_Clean <- as.factor(ifelse(df$Employment == "In full-time education" | df$Employment =="In paid employment, self-employed or on gov't training", "Employed/Full-Time Training or Education", ifelse(df$Employment == "Retired", "Retired", "Unemployed/Other")))
df$FV <- as.factor(ifelse(df$Fruit == "Yes" | df$Veg == "Yes", "Yes", "No"))
df$AgeCategory <- as.factor(ifelse(df$AgeGroup %in% c("16-24", "25-34"), "Young",
ifelse(df$AgeGroup %in% c("35-44", "45-54", "55-64"), "Middle-aged",
"Old")))
df$AgeCategory <- relevel(df$AgeCategory, ref = "Young")
#| echo: false
mod1 <- glm(Obese ~ Sex + Year + FV + AgeCategory + Employment_Clean, data = df, family = binomial)
mod1_tidy <- mod1 %>% broom::tidy() %>% gt()
mod1_tidy
step.model <- stepAIC(mod1, direction = "backward", trace = FALSE)
library(ggplot2)
library(tidyverse)
library(gt)
library(MASS)
library(patchwork)
library(moderndive)
step.model <- stepAIC(mod1, direction = "backward", trace = FALSE)
# trace = FALSE here is to prevent the R output from being printing in the Markdown document. To see the steps of the process and determine the final model set trace = TRUE.
Coefs <- round(coef(step.model), 3)
AIC <- step.model$anova[, 6]
AIC
step.model
View(df)
mod_all <- glm(Obese ~ Sex + Year + FV + AgeGroup + Employment, data = df, family = binomial)
mod_all <- glm(Obese ~ Sex + Year + FV + AgeGroup + Employment, data = df, family = binomial)
step.model.all <- stepAIC(mod_all, direction = "backward", trace = FALSE)
# trace = FALSE here is to prevent the R output from being printing in the Markdown document. To see the steps of the process and determine the final model set trace = TRUE.
Coefs <- round(coef(step.model.all), 3)
AIC <- step.model.all$anova[, 6]
step.model.all
mod1_tidy <- mod1 %>% broom::tidy() %>% gt()
mod1_tidy
View(mod1)
View(df)
pred_results <- mod.1 %>%
augment(type.predict = c("response")) %>%
mutate(predicted_class = factor(ifelse(.fitted > 0.5, "Yes", "No")))
pred_results <- mod1 %>%
augment(type.predict = c("response")) %>%
mutate(predicted_class = factor(ifelse(.fitted > 0.5, "Yes", "No")))
View(pred_results)
View(df)
roc_curve(pred_results,
truth = Obese,
.fitted,
event_level = "second") %>%
autoplot()
pred_results <- step.model %>%
augment(type.predict = c("response")) %>%
mutate(predicted_class = factor(ifelse(.fitted > 0.5, "Yes", "No")))
roc_curve(pred_results,
truth = Obese,
.fitted,
event_level = "second") %>%
autoplot()
AIC <- step.model.all$anova[, 6]
AIC
AIC <- step.model.all$anova[, 6]
AIC
step.model <- stepAIC(mod1, direction = "backward", trace = FALSE)
# trace = FALSE here is to prevent the R output from being printing in the Markdown document. To see the steps of the process and determine the final model set trace = TRUE.
Coefs <- round(coef(step.model), 3)
AIC <- step.model$anova[, 6]
AIC
AIC(mod1)
#| echo: false
#| warning: false
#| message: false
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidymodels)
library(sjPlot)
library(performance)
library(kableExtra)
library(gt)
#| echo: false
#| warning: false
#| message: false
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidymodels)
library(sjPlot)
library(performance)
library(kableExtra)
library(gt)
#| echo: false
mod1 <- glm(Obese ~ Sex + Year + FV + AgeCategory + Employment_Clean, data = df, family = binomial)
df <- read.csv("DAProject3.csv")
df <- df %>%
mutate(
Sex = as.factor(Sex),
AgeGroup = as.factor(AgeGroup),
Veg = as.factor(Veg),
Fruit = as.factor(Fruit),
Obese = as.factor(Obese),
Employment = as.factor(Employment)
)
df$Employment_Clean <- as.factor(ifelse(df$Employment == "In full-time education" | df$Employment =="In paid employment, self-employed or on gov't training", "Employed/Full-Time Training or Education", ifelse(df$Employment == "Retired", "Retired", "Unemployed/Other")))
df$FV <- as.factor(ifelse(df$Fruit == "Yes" | df$Veg == "Yes", "Yes", "No"))
df$AgeCategory <- as.factor(ifelse(df$AgeGroup %in% c("16-24", "25-34"), "Young",
ifelse(df$AgeGroup %in% c("35-44", "45-54", "55-64"), "Middle-aged",
"Old")))
df$AgeCategory <- relevel(df$AgeCategory, ref = "Young")
#| echo: false
mod1 <- glm(Obese ~ Sex + Year + FV + AgeCategory + Employment_Clean, data = df, family = binomial)
mod1_tidy <- mod1 %>% broom::tidy() %>% gt()
mod1_tidy
# potentially cut
step.model <- stepAIC(mod1, direction = "backward", trace = TRUE)
# potentially cut
step.model <- stepAIC(mod2, direction = "backward", trace = TRUE)
#| echo: false
mod2 <- glm(Obese ~ Sex + Year + FV + AgeCategory + Employment_Clean, data = df, family = binomial)
mod2_tidy <- mod2 %>% broom::tidy() %>% gt()
AIC_mod2 <- AIC(mod2)
# potentially cut
step.model <- stepAIC(mod2, direction = "backward", trace = TRUE)
#| echo: false
#| warning: false
#| message: false
library(ggplot2)
library(dplyr)
library(tidyr)
library(tidymodels)
library(sjPlot)
library(performance)
library(kableExtra)
library(gt)
library(tidyverse)
library(gt)
library(MASS)
library(patchwork)
library(moderndive)
# potentially cut
step.model <- stepAIC(mod2, direction = "backward", trace = TRUE)
mod2_tidy
#| echo: false
library(performance)
check_model(mod2, panel = TRUE)
check_model(mod2, panel = TRUE)
check_model(mod2, panel = TRUE)
check_outliers(mod2)
